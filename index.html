<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 æ•¸å¯¦ç¥­ - å­¸ç¿’æ–™ç†å¯¦é©—å®¤</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out',
                        'scale-up': 'scaleUp 0.3s ease-out',
                        'spin-slow': 'spin 3s linear infinite',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        scaleUp: { '0%': { opacity: '0', transform: 'scale(0.95)' }, '100%': { opacity: '1', transform: 'scale(1)' } }
                    },
                    colors: { brand: { 50: '#fff7ed', 100: '#ffedd5', 500: '#f97316', 600: '#ea580c', 700: '#c2410c', 900: '#7c2d12' } }
                }
            }
        }
    </script>
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        body { background-color: #fefce8; margin: 0; padding: 0; min-height: 100vh; overflow-x: hidden; font-family: sans-serif; }
        #root { min-height: 100vh; }
        button:active { transform: scale(0.95); }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- è¼‰å…¥ UMD ç‰ˆæœ¬çš„ React èˆ‡ Firebase -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- âš™ï¸ ç’°å¢ƒé…ç½®è™•ç† ---
        const firebaseConfig = typeof __firebase_config !== 'undefined' 
            ? JSON.parse(__firebase_config) 
            : {
                apiKey: "YOUR_FIREBASE_API_KEY",
                authDomain: "YOUR_PROJECT.firebaseapp.com",
                projectId: "YOUR_PROJECT",
                storageBucket: "YOUR_PROJECT.appspot.com",
                messagingSenderId: "...",
                appId: "..."
            };

        const appId = typeof __app_id !== 'undefined' ? __app_id : 'learning-kitchen-2026';
        const apiKey = ""; // Imagen API Key

        // åˆå§‹åŒ– Firebase
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const auth = firebase.auth();
        const db = firebase.firestore();

        // --- ğŸ› ï¸ è¼”åŠ©å·¥å…·ï¼šåœ–ç‰‡å£“ç¸® (é˜²æ­¢è¶…é Firestore 1MB é™åˆ¶) ---
        const compressImage = (base64Str, maxWidth = 800, quality = 0.7) => {
            return new Promise((resolve) => {
                const img = new Image();
                img.src = base64Str;
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    let width = img.width;
                    let height = img.height;
                    if (width > maxWidth) {
                        height = (maxWidth / width) * height;
                        width = maxWidth;
                    }
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    resolve(canvas.toDataURL('image/jpeg', quality));
                };
            });
        };

        // --- ğŸ¨ SVG åœ–æ¨™çµ„ä»¶ ---
        const Icon = ({ name, size = 24, className = "" }) => {
            const icons = {
                BookOpen: <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2zM22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />,
                ChefHat: <path d="M6 18h12M12 10a4 4 0 1 1 0-8 4 4 0 1 1 0 8zM9 14a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM21 14a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM17 18a3 3 0 0 1 0 6H7a3 3 0 0 1 0-6" />,
                Flame: <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z" />,
                Utensils: <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2M7 2v20M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7" />,
                Camera: <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3zM12 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />,
                ArrowRight: <path d="M5 12h14M12 5l7 7-7 7" />,
                ArrowLeft: <path d="M19 12H5M12 19l-7-7 7-7" />,
                Check: <path d="M20 6L9 17l-5-5" />,
                Sparkles: <path d="m12 3 1.912 5.813a2 2 0 0 0 1.275 1.275L21 12l-5.813 1.912a2 2 0 0 0-1.275 1.275L12 21l-1.912-5.813a2 2 0 0 0-1.275-1.275L3 12l5.813-1.912a2 2 0 0 0 1.275-1.275L12 3Z" />,
                Share2: <path d="M18 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM6 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM18 22a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM8.59 13.51l6.83 3.98M15.41 6.51l-6.82 3.98" />,
                X: <path d="M18 6L6 18M6 6l12 12" />,
                User: <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2M12 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8z" />,
                AlertCircle: <React.Fragment><circle cx="12" cy="12" r="10" /><line x1="12" y1="8" x2="12" y2="12" /><line x1="12" y1="16" x2="12.01" y2="16" /></React.Fragment>,
                Info: <React.Fragment><circle cx="12" cy="12" r="10" /><line x1="12" y1="16" x2="12" y2="12" /><line x1="12" y1="8" x2="12.01" y2="8" /></React.Fragment>
            };
            return (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icons[name]}
                </svg>
            );
        };

        function App() {
            const [user, setUser] = useState(null);
            const [view, setView] = useState('landing');
            const [loading, setLoading] = useState(false);
            const [currentStep, setCurrentStep] = useState(0);
            const [message, setMessage] = useState(null);
            const [formData, setFormData] = useState({
                creatorName: '', dishName: '', mainIngredient: '', methods: [], spices: [], spiceReason: '', skillLevel: 'åˆå­¸', skillType: '', platingStyle: '', generatedImageUrl: null,
            });
            const [galleryItems, setGalleryItems] = useState([]);
            const [selectedItem, setSelectedItem] = useState(null);

            useEffect(() => {
                const initAuth = async () => {
                    try {
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await auth.signInWithCustomToken(__initial_auth_token);
                        } else {
                            await auth.signInAnonymously();
                        }
                    } catch (err) {
                        console.error("Auth initialization failed:", err);
                    }
                };
                initAuth();
                const unsubscribe = auth.onAuthStateChanged(setUser);
                return () => unsubscribe();
            }, []);

            useEffect(() => {
                if (!user) return;
                const path = `artifacts/${appId}/public/data/kitchen_dishes`;
                const unsubscribe = db.collection(path).onSnapshot((snapshot) => {
                    const items = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    items.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));
                    setGalleryItems(items);
                }, (err) => {
                    console.error("Firestore Listen Error:", err);
                });
                return () => unsubscribe();
            }, [user, appId]);

            const showMsg = (text, type = 'info') => {
                setMessage({ text, type });
                setTimeout(() => setMessage(null), 3000);
            };

            const handleGenerate = async () => {
                setLoading(true);
                const promptText = `Artistic professional food photography of a dish named "${formData.dishName}". Theme: "${formData.mainIngredient}". Style: "${formData.platingStyle}". Warm lighting, appetizing, high resolution.`;
                
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            instances: { prompt: promptText }, 
                            parameters: { sampleCount: 1 } 
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.predictions?.[0]?.bytesBase64Encoded) {
                        const rawImage = `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                        // å£“ç¸®åœ–ç‰‡ç¢ºä¿ä¸æœƒè¶…é Firestore é™åˆ¶
                        const compressedImage = await compressImage(rawImage);
                        setFormData(prev => ({ ...prev, generatedImageUrl: compressedImage }));
                        setView('result');
                    } else { 
                        throw new Error("AI Generation failed"); 
                    }
                } catch (e) {
                    console.error("Generation Error:", e);
                    showMsg("ä½¿ç”¨é è¨­ç¤ºæ„åœ–ä¸­", "info");
                    setFormData(prev => ({ ...prev, generatedImageUrl: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=800" }));
                    setView('result');
                } finally { 
                    setLoading(false); 
                }
            };

            const handlePublish = async () => {
                if (!user) {
                    showMsg("å°šæœªå®Œæˆèº«ä»½é©—è­‰ï¼Œè«‹ç¨å€™", "error");
                    return;
                }
                setLoading(true);
                try {
                    const path = `artifacts/${appId}/public/data/kitchen_dishes`;
                    // åŸ·è¡ŒåˆŠç™»å‰å†æ¬¡ç¢ºä¿åœ–ç‰‡å¤§å° (é›™é‡ä¿éšœ)
                    const finalData = { ...formData };
                    if (finalData.generatedImageUrl && finalData.generatedImageUrl.length > 800000) {
                        finalData.generatedImageUrl = await compressImage(finalData.generatedImageUrl, 600, 0.5);
                    }

                    await db.collection(path).add({ 
                        ...finalData, 
                        userId: user.uid, 
                        createdAt: firebase.firestore.FieldValue.serverTimestamp() 
                    });
                    showMsg("æ–™ç†å·²ç«¯ä¸Šå±•ç¤ºç‰†ï¼", "success");
                    setView('gallery');
                } catch (e) { 
                    console.error("Publish Error Details:", e);
                    if (e.code === 'permission-denied') {
                        showMsg("åˆŠç™»å¤±æ•—ï¼šæ¬Šé™ä¸è¶³ï¼Œè«‹è¯ç¹«ç®¡ç†å“¡", "error");
                    } else if (e.message.includes("too large")) {
                        showMsg("åˆŠç™»å¤±æ•—ï¼šåœ–ç‰‡æ•¸æ“šå¤ªå¤§", "error");
                    } else {
                        showMsg("åˆŠç™»å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦", "error");
                    }
                } finally { 
                    setLoading(false); 
                }
            };

            // ... (å…¶é¤˜ UI èˆ‡é‚è¼¯ä¿æŒä¸è®Š)
            const isNextDisabled = () => {
                if (currentStep === 0) return !formData.dishName || !formData.creatorName;
                if (currentStep === 1) return !formData.mainIngredient;
                if (currentStep === 2) return formData.methods.length === 0;
                if (currentStep === 3) return !formData.spiceReason;
                if (currentStep === 4) return !formData.skillType;
                if (currentStep === 5) return !formData.platingStyle;
                return false;
            };

            const steps = ["å‘½å", "ç”¢åœ°", "å‚™æ–™", "èª¿å‘³", "ç«å€™", "æ“ºç›¤"];
            const stepIcons = ["BookOpen", "Utensils", "ChefHat", "Sparkles", "Flame", "Camera"];

            return (
                <div className="min-h-screen flex flex-col max-w-4xl mx-auto bg-white/50 shadow-inner">
                    {/* æç¤ºè¨Šæ¯ */}
                    {message && (
                        <div className="fixed top-6 left-1/2 -translate-x-1/2 z-[200] animate-fade-in">
                            <div className={`px-6 py-3 rounded-full shadow-2xl flex items-center gap-3 ${message.type === 'error' ? 'bg-red-600' : 'bg-brand-600'} text-white`}>
                                <Icon name={message.type === 'error' ? 'AlertCircle' : 'Info'} size={20} />
                                <span className="font-bold">{message.text}</span>
                            </div>
                        </div>
                    )}

                    {/* è¼‰å…¥ä¸­å‹•ç•« */}
                    {loading && (
                        <div className="fixed inset-0 bg-brand-900/90 z-[150] flex flex-col items-center justify-center text-white backdrop-blur-md">
                            <div className="w-20 h-20 border-8 border-brand-500/30 border-t-brand-500 rounded-full animate-spin"></div>
                            <h2 className="text-2xl font-black mt-8 tracking-widest uppercase">ä¸»å»šæ­£åœ¨è™•ç†ä¸­...</h2>
                        </div>
                    )}

                    {/* é¦–é  */}
                    {view === 'landing' && (
                        <div className="flex-1 flex flex-col items-center justify-center p-6 text-center animate-scale-up">
                            <div className="glass-card p-8 sm:p-12 rounded-[3.5rem] shadow-2xl max-w-xl w-full border-8 border-brand-100">
                                <Icon name="ChefHat" size={80} className="text-brand-600 mx-auto mb-8" />
                                <h1 className="text-4xl font-black text-slate-900 mb-2">2026 æ•¸å¯¦ç¥­</h1>
                                <p className="text-brand-600 font-black text-2xl mb-8 tracking-widest uppercase">å­¸ç¿’æ–™ç†å¯¦é©—å®¤</p>
                                <p className="text-slate-500 mb-10 text-lg leading-relaxed font-medium">åœ¨é€™è£¡ï¼Œæ¯ä¸€ç¨®å­¸ç§‘éƒ½æ˜¯é£Ÿæï¼Œæ¯ä¸€é …æŠ€èƒ½éƒ½æ˜¯èª¿å‘³ã€‚æ‚¨ï¼Œæƒ³ç…®å‡ºä¸€é“ä»€éº¼æ¨£çš„å­¸ç¿’æ–™ç†ï¼Ÿ</p>
                                <div className="flex flex-col gap-4">
                                    <button onClick={() => setView('cooking')} className="w-full py-5 bg-brand-600 hover:bg-brand-700 text-white rounded-[2rem] font-black text-xl shadow-xl transition-all flex items-center justify-center gap-3">
                                        <Icon name="Utensils" /> é–‹å§‹è£½ä½œæ–™ç†
                                    </button>
                                    <button onClick={() => setView('gallery')} className="w-full py-5 bg-white border-4 border-brand-100 text-brand-700 rounded-[2rem] font-bold text-lg hover:bg-brand-50 transition-colors">
                                        åƒè§€æˆæœå±•ç¤ºç‰†
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* è£½ä½œéç¨‹ */}
                    {view === 'cooking' && (
                        <div className="flex-1 w-full bg-white shadow-2xl flex flex-col animate-fade-in relative overflow-hidden">
                            <header className="bg-brand-600 p-6 text-white flex justify-between items-center sticky top-0 z-50">
                                <button onClick={() => setView('landing')} className="p-3 bg-white/10 rounded-2xl hover:bg-white/20 transition-colors"><Icon name="ArrowLeft" /></button>
                                <div className="flex flex-col items-center">
                                    <span className="text-[10px] font-black uppercase opacity-60 tracking-widest">æ­£åœ¨é–‹ç™¼æ–™ç†</span>
                                    <span className="font-black text-xl truncate max-w-[150px]">{formData.dishName || 'æ–°æ–™ç†'}</span>
                                </div>
                                <div className="w-12"></div>
                            </header>
                            
                            <div className="px-6 py-4 flex gap-2 overflow-x-auto no-scrollbar border-b bg-white">
                                {steps.map((s, i) => (
                                    <div key={i} className={`flex items-center gap-2 px-4 py-2 rounded-full whitespace-nowrap transition-all ${i === currentStep ? 'bg-brand-600 text-white shadow-md' : i < currentStep ? 'bg-brand-50 text-brand-600' : 'bg-slate-50 text-slate-300'}`}>
                                        <Icon name={stepIcons[i]} size={16} /> <span className="font-black text-xs uppercase tracking-tighter">{s}</span>
                                    </div>
                                ))}
                            </div>

                            <div className="flex-1 p-8 overflow-y-auto pb-32">
                                {currentStep === 0 && (
                                    <div className="space-y-8 animate-fade-in">
                                        <h2 className="text-3xl font-black text-slate-900 tracking-tight">ç‚ºæ–™ç†å‘½å</h2>
                                        <div className="space-y-6">
                                            <div className="space-y-2">
                                                <label className="block text-xs font-black text-slate-400 uppercase tracking-widest ml-1">æ–™ç†ä¸»é¡Œ</label>
                                                <input type="text" placeholder="ä¾‹å¦‚ï¼šç¨‹å¼é‚è¼¯ç´…ç‡’è‚‰" className="w-full p-6 text-2xl font-bold border-4 border-slate-100 rounded-3xl focus:border-brand-500 outline-none bg-slate-50 transition-all"
                                                    value={formData.dishName} onChange={(e) => setFormData({...formData, dishName: e.target.value})} />
                                            </div>
                                            <div className="space-y-2">
                                                <label className="block text-xs font-black text-slate-400 uppercase tracking-widest ml-1">ä¸»å»šç°½å</label>
                                                <div className="relative">
                                                    <input type="text" placeholder="ä¾‹å¦‚ï¼šé«˜äºŒèª  ç‹å°æ˜" className="w-full p-5 pl-14 text-lg border-4 border-slate-100 rounded-2xl focus:border-brand-500 outline-none bg-slate-50 transition-all"
                                                        value={formData.creatorName} onChange={(e) => setFormData({...formData, creatorName: e.target.value})} />
                                                    <Icon name="User" className="absolute left-5 top-1/2 -translate-y-1/2 text-slate-300" size={20} />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                                {currentStep === 1 && (
                                    <div className="space-y-6 animate-fade-in">
                                        <h2 className="text-3xl font-black text-slate-900 tracking-tight">ç”¢åœ°é£Ÿæ</h2>
                                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                            {["äººæ–‡ç¤¾æœƒ", "è‡ªç„¶ç§‘å­¸", "è—è¡“è¨­è¨ˆ", "ç¨‹å¼è³‡è¨Š", "å¿ƒç†æ¢ç´¢", "å•†æ¥­ç®¡ç†", "èªè¨€æ–‡åŒ–"].map(item => (
                                                <div key={item} onClick={() => setFormData({...formData, mainIngredient: item})} className={`p-5 rounded-2xl border-4 transition-all cursor-pointer ${formData.mainIngredient === item ? 'border-brand-500 bg-brand-50 shadow-md' : 'border-slate-100 bg-slate-50 text-slate-600 hover:border-slate-200'}`}>
                                                    <span className="font-black text-xl">{item}</span>
                                                    <div className="text-xs opacity-60 font-bold uppercase tracking-tighter mt-1">æ•¸ä½å¯¦ä¸­ç²¾é¸é ˜åŸŸ</div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                                {currentStep === 2 && (
                                    <div className="space-y-6 animate-fade-in">
                                        <h2 className="text-3xl font-black text-slate-900 tracking-tight">å‚™æ–™æ–¹æ³• (æœ€å¤šå…©é …)</h2>
                                        <div className="grid grid-cols-2 gap-4">
                                            {["ç¨ç«‹ç ”ç©¶", "å°çµ„åˆä½œ", "AI å”ä½œ", "ç”°é‡èª¿æŸ¥", "æ–‡ç»åˆ†æ", "å¯¦ä½œå¯¦é©—"].map(item => (
                                                <div key={item} onClick={() => {
                                                    const list = formData.methods.includes(item) ? formData.methods.filter(x => x !== item) : [...formData.methods, item].slice(0, 2);
                                                    setFormData({...formData, methods: list});
                                                }} className={`p-5 rounded-2xl border-4 transition-all cursor-pointer ${formData.methods.includes(item) ? 'border-blue-500 bg-blue-50 shadow-md' : 'border-slate-100 bg-slate-50 text-slate-600 hover:border-slate-200'}`}>
                                                    <div className="flex justify-between items-center">
                                                        <span className="font-black text-lg">{item}</span>
                                                        {formData.methods.includes(item) && <Icon name="Check" size={20} className="text-blue-600" />}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                                {currentStep === 3 && (
                                    <div className="space-y-6 animate-fade-in">
                                        <h2 className="text-3xl font-black text-slate-900 tracking-tight">ç¨å®¶èª¿å‘³</h2>
                                        <div className="flex flex-wrap gap-2">
                                            {["SDGs æ°¸çºŒ", "åœ¨åœ°æ–‡åŒ–", "ç§‘æŠ€å€«ç†", "ç¤¾æœƒæ­£ç¾©", "å¿ƒç†å¥åº·", "å‰µæ–°å‰µæ¥­"].map(item => (
                                                <button key={item} onClick={() => {
                                                    const list = formData.spices.includes(item) ? formData.spices.filter(x => x !== item) : [...formData.spices, item].slice(0, 3);
                                                    setFormData({...formData, spices: list});
                                                }} className={`px-5 py-2 rounded-full border-2 font-bold transition-all text-sm ${formData.spices.includes(item) ? 'bg-red-500 text-white border-red-500 shadow-md scale-105' : 'bg-white text-slate-500 border-slate-100 hover:border-red-200'}`}>
                                                    {item}
                                                </button>
                                            ))}
                                        </div>
                                        <div className="space-y-2">
                                            <label className="text-xs font-black text-slate-400 ml-1 uppercase">ä¸»å»šçš„å¿ƒå¾—èª¿å‘³ï¼ˆå¿…å¡«ï¼‰</label>
                                            <textarea placeholder="é€™ä»½å­¸ç¿’ç¶“æ­·å°æ‚¨çš„æ„ç¾©æ˜¯..." className="w-full p-6 border-4 border-slate-100 rounded-3xl focus:border-red-500 h-32 bg-slate-50 resize-none font-medium outline-none transition-all"
                                                value={formData.spiceReason} onChange={(e) => setFormData({...formData, spiceReason: e.target.value})} />
                                        </div>
                                    </div>
                                )}
                                {currentStep === 4 && (
                                    <div className="space-y-8 animate-fade-in">
                                        <h2 className="text-3xl font-black text-slate-900 tracking-tight">æŒæ§ç«å€™</h2>
                                        <div className="grid grid-cols-2 gap-3">
                                            {["å½±ç‰‡å‰ªè¼¯", "ç¨‹å¼è¨­è¨ˆ", "å£èªè¡¨é”", "æ•¸æ“šåˆ†æ", "å¹³é¢è¨­è¨ˆ", "å°ˆæ¡ˆç®¡ç†"].map(s => (
                                                <button key={s} onClick={() => setFormData({...formData, skillType: s})} className={`p-5 rounded-2xl border-4 transition-all text-left font-black ${formData.skillType === s ? 'border-brand-500 bg-brand-50 shadow-md' : 'border-slate-100 bg-slate-50'}`}>
                                                    {s}
                                                </button>
                                            ))}
                                        </div>
                                        {formData.skillType && (
                                            <div className="flex gap-2">
                                                {["åˆå­¸", "ç†Ÿç·´", "å°ˆç²¾"].map(lvl => (
                                                    <button key={lvl} onClick={() => setFormData({...formData, skillLevel: lvl})}
                                                        className={`flex-1 py-4 rounded-2xl font-black border-4 transition-all ${formData.skillLevel === lvl ? 'bg-brand-600 text-white border-brand-600 shadow-lg' : 'bg-slate-50 border-slate-100 text-slate-400'}`}>
                                                        {lvl}
                                                    </button>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                )}
                                {currentStep === 5 && (
                                    <div className="space-y-6 animate-fade-in">
                                        <h2 className="text-3xl font-black text-slate-900 tracking-tight">ç²¾ç·»æ“ºç›¤</h2>
                                        <div className="grid grid-cols-1 gap-4">
                                            {["å°ˆæ¥­ç°¡å ±å‹", "ç¤¾ç¾¤å‰µä½œå‹", "å­¸è¡“ç ”ç©¶å‹", "å‰µæ„å¸‚é›†å‹"].map(name => (
                                                <div key={name} onClick={() => setFormData({...formData, platingStyle: name})} className={`p-6 rounded-2xl border-4 transition-all cursor-pointer ${formData.platingStyle === name ? 'border-emerald-500 bg-emerald-50 shadow-md' : 'border-slate-100 bg-slate-50'}`}>
                                                    <span className="font-black text-xl">{name}</span>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>

                            <footer className="p-8 border-t bg-slate-50 flex justify-between items-center absolute bottom-0 left-0 right-0 z-50">
                                <button onClick={() => setCurrentStep(c => Math.max(0, c - 1))} className={`font-black text-slate-400 flex items-center gap-2 px-4 py-2 transition-colors ${currentStep === 0 ? 'invisible pointer-events-none' : 'hover:text-slate-600'}`}>
                                    <Icon name="ArrowLeft" size={18}/> ä¸Šä¸€æ­¥
                                </button>
                                {currentStep < 5 ? (
                                    <button onClick={() => setCurrentStep(c => c + 1)} disabled={isNextDisabled()}
                                        className="px-10 py-4 bg-brand-600 hover:bg-brand-700 text-white rounded-2xl font-black shadow-xl shadow-brand-100 flex items-center gap-3 disabled:opacity-30 transition-all">
                                        ä¸‹ä¸€æ­¥ <Icon name="ArrowRight" size={20} />
                                    </button>
                                ) : (
                                    <button onClick={handleGenerate} disabled={isNextDisabled()}
                                        className="px-10 py-4 bg-emerald-600 hover:bg-emerald-700 text-white rounded-2xl font-black shadow-xl shadow-emerald-100 flex items-center gap-3 animate-pulse transition-all">
                                        <Icon name="Sparkles" size={20} /> AI ç«¯ä¸Šæ¡Œ
                                    </button>
                                )}
                            </footer>
                        </div>
                    )}

                    {/* ç”Ÿæˆçµæœ */}
                    {view === 'result' && (
                        <div className="flex-1 bg-brand-950 flex flex-col items-center justify-center p-4">
                            <div className="bg-white rounded-[3.5rem] overflow-hidden shadow-2xl max-w-lg w-full border-[12px] border-white animate-scale-up">
                                <div className="relative aspect-square">
                                    <img src={formData.generatedImageUrl} className="w-full h-full object-cover" alt="Result" />
                                    <div className="absolute top-6 right-6 bg-brand-600 text-white px-5 py-2 rounded-full font-black text-xs uppercase tracking-widest shadow-lg">
                                        {formData.platingStyle}
                                    </div>
                                </div>
                                <div className="p-10 space-y-6 text-slate-900">
                                    <div className="flex justify-between items-end border-b pb-4">
                                        <div className="text-brand-600 font-black text-sm uppercase tracking-widest flex items-center gap-2">
                                            <Icon name="Utensils" size={16} /> {formData.mainIngredient}
                                        </div>
                                        <div className="text-slate-400 font-bold text-xs">ä¸»å»šï¼š{formData.creatorName}</div>
                                    </div>
                                    <h1 className="text-4xl font-black leading-tight tracking-tighter">{formData.dishName}</h1>
                                    <div className="bg-brand-50 p-8 rounded-[2.5rem] relative border border-brand-100">
                                        <p className="text-brand-800 font-bold italic text-xl leading-relaxed">{formData.spiceReason}</p>
                                    </div>
                                    <div className="flex gap-4 pt-4">
                                        <button onClick={() => setView('cooking')} className="flex-1 py-4 text-slate-400 font-black hover:bg-slate-50 rounded-2xl transition-all">ä¿®æ”¹é£Ÿè­œ</button>
                                        <button onClick={handlePublish} className="flex-[2] py-4 bg-brand-600 text-white font-black rounded-2xl shadow-xl shadow-brand-100 hover:bg-brand-700 transition-all flex items-center justify-center gap-2">
                                            <Icon name="Share2" size={20}/> åˆŠç™»æˆæœ
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* ä½œå“å±•ç¤ºç‰† */}
                    {view === 'gallery' && (
                        <div className="flex-1 bg-slate-950 text-white p-6 sm:p-12 flex flex-col">
                            <header className="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-8 mb-16">
                                <div className="space-y-3">
                                    <h1 className="text-5xl font-black flex items-center gap-5">ğŸ½ï¸ æ•¸ä½è¾¦æ¡Œå±•ç¤ºç‰†</h1>
                                    <p className="text-slate-500 font-black tracking-widest uppercase ml-1">çœ‹è¦‹æ•¸ä½å¯¦ä¸­å­¸ç”Ÿçš„å­¸ç¿’ç™¾å‘³</p>
                                </div>
                                <button onClick={() => { 
                                    setFormData({ creatorName: '', dishName: '', mainIngredient: '', methods: [], spices: [], spiceReason: '', skillLevel: 'åˆå­¸', skillType: '', platingStyle: '', generatedImageUrl: null }); 
                                    setCurrentStep(0); setView('landing'); 
                                }} className="px-12 py-5 bg-brand-600 hover:bg-brand-700 text-white rounded-[2rem] font-black shadow-2xl transition-all">
                                    æˆ‘ä¹Ÿè¦åšæ–™ç†
                                </button>
                            </header>
                            
                            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-10">
                                {galleryItems.map((item) => (
                                    <div key={item.id} onClick={() => setSelectedItem(item)} className="group bg-slate-900 rounded-[2.5rem] overflow-hidden cursor-pointer hover:ring-8 ring-brand-500/50 transition-all duration-300 flex flex-col hover:-translate-y-3 shadow-2xl">
                                        <div className="aspect-square overflow-hidden relative">
                                            <img src={item.generatedImageUrl} className="w-full h-full object-cover grayscale-[0.3] group-hover:grayscale-0 transition-all duration-700" loading="lazy" />
                                            <div className="absolute inset-0 bg-gradient-to-t from-slate-950 via-transparent to-transparent opacity-80"></div>
                                            <div className="absolute bottom-6 left-6 flex gap-2">
                                                <span className="bg-brand-600 text-[10px] font-black px-3 py-1 rounded shadow-2xl uppercase tracking-widest">{item.mainIngredient}</span>
                                            </div>
                                        </div>
                                        <div className="p-8">
                                            <h3 className="font-black text-2xl group-hover:text-brand-500 transition-colors truncate mb-1">{item.dishName}</h3>
                                            <div className="text-slate-500 font-bold text-xs mb-4">ä¸»å»šï¼š{item.creatorName}</div>
                                            <p className="text-slate-400 text-sm italic line-clamp-2 opacity-70">"{item.spiceReason}"</p>
                                        </div>
                                    </div>
                                ))}
                            </div>

                            {/* ä½œå“è©³æƒ…å½ˆçª— */}
                            {selectedItem && (
                                <div className="fixed inset-0 z-[200] flex items-center justify-center p-4 bg-slate-950/98 backdrop-blur-2xl animate-fade-in" onClick={() => setSelectedItem(null)}>
                                    <div className="bg-white rounded-[4rem] max-w-2xl w-full max-h-[90vh] overflow-y-auto text-slate-900 shadow-2xl animate-scale-up" onClick={e => e.stopPropagation()}>
                                        <div className="relative aspect-square">
                                            <img src={selectedItem.generatedImageUrl} className="w-full h-full object-cover" alt="Detail" />
                                            <button onClick={() => setSelectedItem(null)} className="absolute top-8 right-8 p-4 bg-black/40 hover:bg-black text-white rounded-[1.5rem] transition-all">
                                                <Icon name="X" size={28} />
                                            </button>
                                        </div>
                                        <div className="p-12 space-y-10">
                                            <div className="border-b-2 border-slate-50 pb-8 flex flex-col gap-4">
                                                <div className="flex items-center gap-3">
                                                    <span className="bg-brand-600 text-white text-[10px] font-black px-4 py-1.5 rounded-full uppercase tracking-widest">{selectedItem.mainIngredient}</span>
                                                    <span className="bg-emerald-50 text-emerald-600 text-[10px] font-black px-4 py-1.5 rounded-full uppercase tracking-widest border border-emerald-100">{selectedItem.platingStyle}</span>
                                                </div>
                                                <h2 className="text-5xl font-black tracking-tighter leading-[1.1]">{selectedItem.dishName}</h2>
                                                <div className="flex items-center gap-3 text-slate-400 font-black uppercase text-sm">
                                                    <Icon name="ChefHat" size={20} className="text-brand-500" /> <span>ä¸»å»šï¼š{selectedItem.creatorName}</span>
                                                </div>
                                            </div>
                                            <div className="bg-brand-50 p-10 rounded-[3.5rem] relative border-2 border-brand-100">
                                                <p className="text-brand-950 font-black italic text-2xl leading-relaxed">{selectedItem.spiceReason}</p>
                                            </div>
                                            <button onClick={() => setSelectedItem(null)} className="w-full py-6 bg-slate-100 hover:bg-slate-200 text-slate-500 rounded-[2rem] font-black transition-all">é—œé–‰è¦–çª—</button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>