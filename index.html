<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 Êï∏ÂØ¶Á•≠ - Â≠∏ÁøíÊñôÁêÜÂØ¶È©óÂÆ§</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-out',
                        'scale-up': 'scaleUp 0.3s ease-out',
                        'spin-slow': 'spin 3s linear infinite',
                    },
                    keyframes: {
                        fadeIn: { '0%': { opacity: '0', transform: 'translateY(10px)' }, '100%': { opacity: '1', transform: 'translateY(0)' } },
                        scaleUp: { '0%': { opacity: '0', transform: 'scale(0.95)' }, '100%': { opacity: '1', transform: 'scale(1)' } }
                    },
                    colors: { 
                        brand: { 50: '#fff7ed', 100: '#ffedd5', 500: '#f97316', 600: '#ea580c', 700: '#c2410c', 900: '#7c2d12' } 
                    }
                }
            }
        }
    </script>
    <style>
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        body { background-color: #fefce8; margin: 0; padding: 0; min-height: 100vh; overflow-x: hidden; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
        #root { min-height: 100vh; }
        button:active { transform: scale(0.95); }
        .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.3); }
        .dish-image-shadow { shadow-offset: {width: 0, height: 20}; shadow-radius: 30; shadow-color: rgba(0,0,0,0.2); }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- ËºâÂÖ• React Ëàá Firebase (UMD ÁâàÊú¨) -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;

        // --- ‚öôÔ∏è ÂÖ®ÂüüÈÖçÁΩÆ ---
        const apiKey = ""; // Âü∑Ë°åÁí∞Â¢ÉÊúÉËá™ÂãïÊèê‰æõ
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'learning-kitchen-2026';
        const firebaseConfig = typeof __firebase_config !== 'undefined' 
            ? JSON.parse(__firebase_config) 
            : { apiKey: "YOUR_API_KEY", projectId: "YOUR_PROJECT_ID", authDomain: "YOUR_AUTH_DOMAIN" };

        // ÂàùÂßãÂåñ Firebase (Compat)
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
        }
        const auth = firebase.auth();
        const db = firebase.firestore();

        // --- üõ†Ô∏è ËºîÂä©Â∑•ÂÖ∑ÔºöÂúñÁâáÂ£ìÁ∏Æ ---
        const compressImage = (base64Str, maxWidth = 800, quality = 0.6) => {
            return new Promise((resolve) => {
                const img = new Image();
                img.src = base64Str;
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    let width = img.width, height = img.height;
                    if (width > maxWidth) { height = (maxWidth / width) * height; width = maxWidth; }
                    canvas.width = width; canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    resolve(canvas.toDataURL('image/jpeg', quality));
                };
                img.onerror = () => resolve(base64Str);
            });
        };

        // --- üé® SVG ÂúñÊ®ôÁµÑ‰ª∂ ---
        const Icon = ({ name, size = 24, className = "" }) => {
            const icons = {
                BookOpen: <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2zM22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z" />,
                ChefHat: <path d="M6 18h12M12 10a4 4 0 1 1 0-8 4 4 0 1 1 0 8zM9 14a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM21 14a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM17 18a3 3 0 0 1 0 6H7a3 3 0 0 1 0-6" />,
                Flame: <path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z" />,
                Utensils: <path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2M7 2v20M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7" />,
                Camera: <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3zM12 13a3 3 0 1 0 0-6 3 3 0 0 0 0 6z" />,
                ArrowRight: <path d="M5 12h14M12 5l7 7-7 7" />,
                ArrowLeft: <path d="M19 12H5M12 19l-7-7 7-7" />,
                Check: <path d="M20 6L9 17l-5-5" />,
                Sparkles: <path d="m12 3 1.912 5.813a2 2 0 0 0 1.275 1.275L21 12l-5.813 1.912a2 2 0 0 0-1.275 1.275L12 21l-1.912-5.813a2 2 0 0 0-1.275-1.275L3 12l5.813-1.912a2 2 0 0 0 1.275-1.275L12 3Z" />,
                Share2: <path d="M18 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM6 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM18 22a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM8.59 13.51l6.83 3.98M15.41 6.51l-6.82 3.98" />,
                X: <path d="M18 6L6 18M6 6l12 12" />,
                User: <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2M12 7a4 4 0 1 0 0-8 4 4 0 0 0 0 8z" />,
                AlertCircle: <React.Fragment><circle cx="12" cy="12" r="10" /><line x1="12" y1="8" x2="12" y2="12" /><line x1="12" y1="16" x2="12.01" y2="16" /></React.Fragment>,
                Info: <React.Fragment><circle cx="12" cy="12" r="10" /><line x1="12" y1="16" x2="12" y2="12" /><line x1="12" y1="8" x2="12.01" y2="8" /></React.Fragment>
            };
            return (
                <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icons[name]}
                </svg>
            );
        };

        function App() {
            const [user, setUser] = useState(null);
            const [view, setView] = useState('landing');
            const [loading, setLoading] = useState(false);
            const [currentStep, setCurrentStep] = useState(0);
            const [message, setMessage] = useState(null);
            const [formData, setFormData] = useState({
                creatorName: '', dishName: '', mainIngredient: '', methods: [], spices: [], spiceReason: '', skillLevel: 'ÂàùÂ≠∏', skillType: '', platingStyle: '', generatedImageUrl: null,
            });
            const [galleryItems, setGalleryItems] = useState([]);
            const [selectedItem, setSelectedItem] = useState(null);

            // Auth Logic (RULE 3)
            useEffect(() => {
                const initAuth = async () => {
                    try {
                        if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                            await auth.signInWithCustomToken(__initial_auth_token);
                        } else {
                            await auth.signInAnonymously();
                        }
                    } catch (e) { console.error("Auth error", e); }
                };
                initAuth();
                const unsubscribe = auth.onAuthStateChanged(setUser);
                return () => unsubscribe();
            }, []);

            // Data Fetching (RULE 1 & 2)
            useEffect(() => {
                if (!user) return;
                const path = `artifacts/${appId}/public/data/kitchen_dishes`;
                const unsubscribe = db.collection(path).onSnapshot((snapshot) => {
                    const items = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                    items.sort((a, b) => (b.createdAt?.seconds || 0) - (a.createdAt?.seconds || 0));
                    setGalleryItems(items);
                }, (err) => console.error("Firestore Error", err));
                return () => unsubscribe();
            }, [user, appId]);

            const showMsg = (text, type = 'info') => {
                setMessage({ text, type });
                setTimeout(() => setMessage(null), 3000);
            };

            const handleGenerate = async () => {
                setLoading(true);
                const prompt = `Artistic high-end food photography of "${formData.dishName}". Ingredients: ${formData.mainIngredient}. Vibe: ${formData.platingStyle}. Professional plating, studio lighting, bokeh background, appetizing.`;
                
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ instances: { prompt }, parameters: { sampleCount: 1 } })
                    });
                    const result = await response.json();
                    
                    if (result.predictions?.[0]?.bytesBase64Encoded) {
                        const raw = `data:image/png;base64,${result.predictions[0].bytesBase64Encoded}`;
                        const compressed = await compressImage(raw, 800, 0.6);
                        setFormData(prev => ({ ...prev, generatedImageUrl: compressed }));
                        setView('result');
                    } else { throw new Error("AI busy"); }
                } catch (e) {
                    showMsg("AI ‰∏ªÂªöÂøôÁ¢å‰∏≠ÔºåÂ∑≤ÁÇ∫ÊÇ®Ê∫ñÂÇôÁ≤æÈÅ∏Á§∫ÊÑèÂúñ", "info");
                    setFormData(prev => ({ ...prev, generatedImageUrl: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=800" }));
                    setView('result');
                } finally { setLoading(false); }
            };

            const handlePublish = async () => {
                if (!user) return;
                setLoading(true);
                try {
                    const path = `artifacts/${appId}/public/data/kitchen_dishes`;
                    await db.collection(path).add({ 
                        ...formData, 
                        userId: user.uid, 
                        createdAt: firebase.firestore.FieldValue.serverTimestamp() 
                    });
                    showMsg("ÊñôÁêÜÊàêÂäüÁ´Ø‰∏äÂ±ïÁ§∫ÁâÜÔºÅ", "success");
                    setView('gallery');
                } catch (e) { 
                    showMsg("ÂàäÁôªÂ§±ÊïóÔºåË´ãÁ®çÂæåÂÜçË©¶", "error"); 
                } finally { setLoading(false); }
            };

            const isNextDisabled = () => {
                if (currentStep === 0) return !formData.dishName || !formData.creatorName;
                if (currentStep === 1) return !formData.mainIngredient;
                if (currentStep === 2) return formData.methods.length === 0;
                if (currentStep === 3) return !formData.spiceReason;
                if (currentStep === 4) return !formData.skillType;
                if (currentStep === 5) return !formData.platingStyle;
                return false;
            };

            const steps = ["ÂëΩÂêç", "Áî¢Âú∞", "ÂÇôÊñô", "Ë™øÂë≥", "ÁÅ´ÂÄô", "Êì∫Áõ§"];
            const stepIcons = ["BookOpen", "Utensils", "ChefHat", "Sparkles", "Flame", "Camera"];

            return (
                <div className="min-h-screen flex flex-col bg-[#fdfaf1]">
                    {message && (
                        <div className="fixed top-8 left-1/2 -translate-x-1/2 z-[200] animate-fade-in">
                            <div className={`px-6 py-3 rounded-full shadow-2xl flex items-center gap-3 ${message.type === 'error' ? 'bg-red-600' : 'bg-brand-600'} text-white`}>
                                <Icon name={message.type === 'error' ? 'AlertCircle' : 'Info'} size={20} />
                                <span className="font-bold tracking-wide">{message.text}</span>
                            </div>
                        </div>
                    )}

                    {loading && (
                        <div className="fixed inset-0 bg-brand-900/90 z-[150] flex flex-col items-center justify-center text-white backdrop-blur-md">
                            <div className="relative">
                                <div className="w-24 h-24 border-8 border-brand-500/20 border-t-brand-500 rounded-full animate-spin"></div>
                                <Icon name="ChefHat" className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-brand-500 animate-pulse" size={32} />
                            </div>
                            <h2 className="text-2xl font-black mt-10 tracking-[0.3em] uppercase">‰∏ªÂªöÊ≠£Âú®Á≤æÂøÉÁÉπË™ø...</h2>
                        </div>
                    )}

                    {view === 'landing' && (
                        <div className="flex-1 flex flex-col items-center justify-center p-6 animate-scale-up">
                            <div className="glass-card p-10 sm:p-16 rounded-[4rem] shadow-2xl max-w-2xl w-full text-center">
                                <div className="w-24 h-24 bg-brand-50 rounded-full flex items-center justify-center mx-auto mb-8 shadow-inner">
                                    <Icon name="ChefHat" size={48} className="text-brand-600" />
                                </div>
                                <h1 className="text-5xl font-black text-slate-900 mb-4 tracking-tight">2026 Êï∏ÂØ¶Á•≠</h1>
                                <p className="text-brand-600 font-black text-2xl mb-10 tracking-[0.2em] uppercase">Â≠∏ÁøíÊñôÁêÜÂØ¶È©óÂÆ§</p>
                                <p className="text-slate-500 mb-12 text-xl leading-relaxed font-medium">Âú®ÈÄôË£°ÔºåÊØè‰∏ÄÁ®ÆÂ≠∏ÁßëÈÉΩÊòØÈ£üÊùêÔºåÊØè‰∏ÄÈ†ÖÊäÄËÉΩÈÉΩÊòØË™øÂë≥„ÄÇ<br/>ÊÇ®ÔºåÊÉ≥ÁÖÆÂá∫‰∏ÄÈÅì‰ªÄÈ∫ºÊ®£ÁöÑÂ≠∏ÁøíÊñôÁêÜÔºü</p>
                                <div className="grid grid-cols-1 sm:grid-cols-2 gap-5">
                                    <button onClick={() => setView('cooking')} className="py-5 bg-brand-600 hover:bg-brand-700 text-white rounded-3xl font-black text-xl shadow-xl shadow-brand-200 transition-all flex items-center justify-center gap-3">
                                        <Icon name="Utensils" /> ÈñãÁôºÊñ∞ÊñôÁêÜ
                                    </button>
                                    <button onClick={() => setView('gallery')} className="py-5 bg-white border-4 border-brand-100 text-brand-700 rounded-3xl font-bold text-xl hover:bg-brand-50 transition-colors">
                                        ÂèÉËßÄÂ±ïÁ§∫ÁâÜ
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {view === 'cooking' && (
                        <div className="flex-1 max-w-3xl mx-auto w-full glass-card shadow-2xl flex flex-col animate-fade-in my-8 rounded-[3rem] overflow-hidden">
                            <header className="bg-brand-600 p-8 text-white flex justify-between items-center">
                                <button onClick={() => setView('landing')} className="p-4 bg-white/10 rounded-2xl hover:bg-white/20 transition-all">
                                    <Icon name="ArrowLeft" />
                                </button>
                                <div className="text-center">
                                    <span className="text-[10px] font-black uppercase opacity-60 tracking-widest block mb-1">Kitchen Step {currentStep + 1}/6</span>
                                    <span className="font-black text-2xl">{formData.dishName || 'Á†îÁôº‰∏≠ÁöÑÊñôÁêÜ'}</span>
                                </div>
                                <div className="w-14"></div>
                            </header>

                            <div className="px-8 py-6 flex gap-3 overflow-x-auto no-scrollbar bg-white/50 border-b">
                                {steps.map((s, i) => (
                                    <div key={i} className={`flex items-center gap-2 px-5 py-2.5 rounded-full transition-all ${i === currentStep ? 'bg-brand-600 text-white shadow-lg' : i < currentStep ? 'bg-brand-50 text-brand-600' : 'bg-slate-100 text-slate-400 opacity-50'}`}>
                                        <Icon name={stepIcons[i]} size={16} />
                                        <span className="font-black text-xs uppercase">{s}</span>
                                    </div>
                                ))}
                            </div>

                            <div className="flex-1 p-10 overflow-y-auto min-h-[400px]">
                                {currentStep === 0 && (
                                    <div className="space-y-10 animate-fade-in">
                                        <h2 className="text-4xl font-black text-slate-900">ÁÇ∫ÊÇ®ÁöÑÂ≠∏ÁøíÊàêÊûúÂëΩÂêç</h2>
                                        <div className="space-y-8">
                                            <div className="space-y-3">
                                                <label className="text-sm font-black text-slate-400 uppercase tracking-widest ml-2">ÊñôÁêÜ‰∏ªÈ°å</label>
                                                <input type="text" placeholder="‰æãÂ¶ÇÔºöÁ®ãÂºèÈÇèËºØÁ¥ÖÁáíËÇâ" className="w-full p-8 text-3xl font-black border-4 border-slate-50 rounded-[2.5rem] focus:border-brand-500 outline-none bg-slate-50/50 transition-all placeholder:text-slate-200"
                                                    value={formData.dishName} onChange={(e) => setFormData({...formData, dishName: e.target.value})} />
                                            </div>
                                            <div className="space-y-3">
                                                <label className="text-sm font-black text-slate-400 uppercase tracking-widest ml-2">‰∏ªÂªöÁ∞ΩÂêç</label>
                                                <div className="relative">
                                                    <input type="text" placeholder="‰æãÂ¶ÇÔºöÈ´ò‰∫åË™† ÁéãÂ∞èÊòé" className="w-full p-6 pl-16 text-xl font-bold border-4 border-slate-50 rounded-3xl focus:border-brand-500 outline-none bg-slate-50/50 transition-all"
                                                        value={formData.creatorName} onChange={(e) => setFormData({...formData, creatorName: e.target.value})} />
                                                    <Icon name="User" className="absolute left-6 top-1/2 -translate-y-1/2 text-slate-300" size={24} />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                                {currentStep === 1 && (
                                    <div className="space-y-8 animate-fade-in text-center sm:text-left">
                                        <h2 className="text-4xl font-black text-slate-900">ÊåëÈÅ∏‰∏ªË¶ÅÈ£üÊùêÈ†òÂüü</h2>
                                        <div className="grid grid-cols-1 sm:grid-cols-2 gap-5">
                                            {["‰∫∫ÊñáÁ§æÊúÉ", "Ëá™ÁÑ∂ÁßëÂ≠∏", "ËóùË°ìË®≠Ë®à", "Á®ãÂºèË≥áË®ä", "ÂøÉÁêÜÊé¢Á¥¢", "ÂïÜÊ•≠ÁÆ°ÁêÜ", "Ë™ûË®ÄÊñáÂåñ"].map(item => (
                                                <button key={item} onClick={() => setFormData({...formData, mainIngredient: item})} className={`p-8 rounded-[2rem] border-4 transition-all text-left group ${formData.mainIngredient === item ? 'border-brand-500 bg-brand-50 shadow-xl' : 'border-slate-50 bg-slate-50/30 hover:border-brand-100 hover:bg-white'}`}>
                                                    <span className={`block font-black text-2xl mb-1 ${formData.mainIngredient === item ? 'text-brand-600' : 'text-slate-600'}`}>{item}</span>
                                                    <span className="text-xs font-bold uppercase tracking-widest opacity-40">Êï∏‰ΩçÂØ¶‰∏≠Á≤æÈÅ∏È†òÂüü</span>
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                )}
                                {currentStep === 2 && (
                                    <div className="space-y-8 animate-fade-in">
                                        <h2 className="text-4xl font-black text-slate-900">ÈÅ∏ÊìáÂÇôÊñôÊñπÊ≥ï <span className="text-brand-500 text-lg ml-2">(ÊúÄÂ§öÈÅ∏ 2 È†Ö)</span></h2>
                                        <div className="grid grid-cols-2 gap-5">
                                            {["Áç®Á´ãÁ†îÁ©∂", "Â∞èÁµÑÂêà‰Ωú", "AI Âçî‰Ωú", "Áî∞ÈáéË™øÊü•", "ÊñáÁçªÂàÜÊûê", "ÂØ¶‰ΩúÂØ¶È©ó"].map(item => (
                                                <button key={item} onClick={() => {
                                                    const list = formData.methods.includes(item) ? formData.methods.filter(x => x !== item) : [...formData.methods, item].slice(0, 2);
                                                    setFormData({...formData, methods: list});
                                                }} className={`p-8 rounded-3xl border-4 transition-all text-left flex justify-between items-center ${formData.methods.includes(item) ? 'border-blue-500 bg-blue-50 shadow-lg' : 'border-slate-50 bg-slate-50/30'}`}>
                                                    <span className="font-black text-xl">{item}</span>
                                                    {formData.methods.includes(item) && <Icon name="Check" size={24} className="text-blue-600" />}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                )}
                                {currentStep === 3 && (
                                    <div className="space-y-10 animate-fade-in">
                                        <h2 className="text-4xl font-black text-slate-900">Âä†ÂÖ•Áç®ÂÆ∂ÂøÉÂæóË™øÂë≥</h2>
                                        <div className="flex flex-wrap gap-3">
                                            {["SDGs Ê∞∏Á∫å", "Âú®Âú∞ÊñáÂåñ", "ÁßëÊäÄÂÄ´ÁêÜ", "Á§æÊúÉÊ≠£Áæ©", "ÂøÉÁêÜÂÅ•Â∫∑", "ÂâµÊñ∞ÂâµÊ•≠"].map(item => (
                                                <button key={item} onClick={() => {
                                                    const list = formData.spices.includes(item) ? formData.spices.filter(x => x !== item) : [...formData.spices, item].slice(0, 3);
                                                    setFormData({...formData, spices: list});
                                                }} className={`px-6 py-3 rounded-full border-2 font-black transition-all ${formData.spices.includes(item) ? 'bg-red-500 text-white border-red-500 shadow-lg scale-105' : 'bg-white text-slate-400 border-slate-100 hover:border-red-100'}`}>
                                                    {item}
                                                </button>
                                            ))}
                                        </div>
                                        <div className="space-y-3">
                                            <label className="text-sm font-black text-slate-400 ml-2 uppercase">ÂøÉÂæóÊÑüÊÇü (ÈÄôÂ∞áÊàêÁÇ∫ÊñôÁêÜÁöÑÈùàÈ≠Ç)</label>
                                            <textarea placeholder="ÈÄô‰ªΩÂ≠∏ÁøíÁ∂ìÊ≠∑Â∞çÊÇ®ÁöÑÊÑèÁæ©ÊòØ..." className="w-full p-8 border-4 border-slate-50 rounded-[2.5rem] focus:border-red-500 h-48 bg-slate-50/50 resize-none font-bold text-xl outline-none transition-all placeholder:text-slate-200"
                                                value={formData.spiceReason} onChange={(e) => setFormData({...formData, spiceReason: e.target.value})} />
                                        </div>
                                    </div>
                                )}
                                {currentStep === 4 && (
                                    <div className="space-y-10 animate-fade-in">
                                        <h2 className="text-4xl font-black text-slate-900">ÊéåÊè°ÈóúÈçµÁÅ´ÂÄôÊäÄËÉΩ</h2>
                                        <div className="grid grid-cols-2 gap-4">
                                            {["ÂΩ±ÁâáÂâ™ËºØ", "Á®ãÂºèË®≠Ë®à", "Âè£Ë™ûË°®ÈÅî", "Êï∏ÊìöÂàÜÊûê", "Âπ≥Èù¢Ë®≠Ë®à", "Â∞àÊ°àÁÆ°ÁêÜ"].map(s => (
                                                <button key={s} onClick={() => setFormData({...formData, skillType: s})} className={`p-6 rounded-3xl border-4 font-black text-lg transition-all ${formData.skillType === s ? 'border-orange-500 bg-orange-50' : 'border-slate-50 bg-slate-50/30'}`}>
                                                    {s}
                                                </button>
                                            ))}
                                        </div>
                                        {formData.skillType && (
                                            <div className="flex gap-4 p-2 bg-slate-50 rounded-3xl">
                                                {["ÂàùÂ≠∏", "ÁÜüÁ∑¥", "Â∞àÁ≤æ"].map(lvl => (
                                                    <button key={lvl} onClick={() => setFormData({...formData, skillLevel: lvl})}
                                                        className={`flex-1 py-5 rounded-2xl font-black text-lg transition-all ${formData.skillLevel === lvl ? 'bg-brand-600 text-white shadow-xl' : 'text-slate-400 hover:text-slate-600'}`}>
                                                        {lvl}
                                                    </button>
                                                ))}
                                            </div>  
                                        )}
                                    </div>
                                )}
                                {currentStep === 5 && (
                                    <div className="space-y-10 animate-fade-in">
                                        <h2 className="text-4xl font-black text-slate-900">ÊúÄÂæåÁöÑÁ≤æÁ∑ªÊì∫Áõ§</h2>
                                        <div className="grid grid-cols-1 gap-5">
                                            {["Â∞àÊ•≠Á∞°Â†±Âûã", "Á§æÁæ§Ââµ‰ΩúÂûã", "Â≠∏Ë°ìÁ†îÁ©∂Âûã", "ÂâµÊÑèÂ∏ÇÈõÜÂûã"].map(name => (
                                                <button key={name} onClick={() => setFormData({...formData, platingStyle: name})} className={`p-8 rounded-[2rem] border-4 transition-all text-left font-black text-2xl ${formData.platingStyle === name ? 'border-emerald-500 bg-emerald-50 shadow-xl' : 'border-slate-50 bg-slate-50/30'}`}>
                                                    {name}
                                                </button>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>

                            <footer className="p-8 bg-slate-50/80 backdrop-blur-md flex justify-between items-center border-t">
                                <button onClick={() => setCurrentStep(c => Math.max(0, c - 1))} className={`font-black text-slate-400 flex items-center gap-2 px-6 py-4 transition-all ${currentStep === 0 ? 'invisible' : 'hover:text-slate-600'}`}>
                                    <Icon name="ArrowLeft" size={20}/> ‰∏ä‰∏ÄÊ≠•
                                </button>
                                {currentStep < 5 ? (
                                    <button onClick={() => setCurrentStep(c => c + 1)} disabled={isNextDisabled()}
                                        className="px-12 py-5 bg-brand-600 hover:bg-brand-700 text-white rounded-3xl font-black text-xl shadow-2xl shadow-brand-100 flex items-center gap-3 disabled:opacity-20 transition-all">
                                        ÁπºÁ∫åË£Ω‰Ωú <Icon name="ArrowRight" size={24} />
                                    </button>
                                ) : (
                                    <button onClick={handleGenerate} disabled={isNextDisabled()}
                                        className="px-12 py-5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-3xl font-black text-xl shadow-2xl shadow-emerald-200 flex items-center gap-3 animate-pulse transition-all">
                                        <Icon name="Sparkles" size={24} /> AI Á´Ø‰∏äÊ°å
                                    </button>
                                )}
                            </footer>
                        </div>
                    )}

                    {view === 'result' && (
                        <div className="flex-1 bg-slate-900 flex flex-col items-center justify-center p-6 animate-scale-up">
                            <div className="bg-white rounded-[4rem] overflow-hidden shadow-2xl max-w-2xl w-full border-[1.5rem] border-white">
                                <div className="relative aspect-square dish-image-shadow rounded-[3rem] overflow-hidden">
                                    <img src={formData.generatedImageUrl} className="w-full h-full object-cover" alt="Result" />
                                    <div className="absolute top-8 right-8 bg-brand-600 text-white px-6 py-2.5 rounded-full font-black text-sm uppercase tracking-[0.2em] shadow-2xl">
                                        {formData.platingStyle}
                                    </div>
                                </div>
                                <div className="p-12 space-y-10">
                                    <div className="border-b pb-8">
                                        <div className="text-brand-600 font-black text-sm uppercase tracking-[0.3em] mb-4 flex items-center gap-3">
                                            <div className="w-2 h-2 bg-brand-600 rounded-full"></div>
                                            {formData.mainIngredient} SPECIALTY
                                        </div>
                                        <h1 className="text-5xl font-black text-slate-900 leading-tight mb-4">{formData.dishName}</h1>
                                        <div className="text-slate-400 font-black text-lg uppercase flex items-center gap-3">
                                            BY CHEF {formData.creatorName}
                                        </div>
                                    </div>
                                    <div className="bg-brand-50 p-10 rounded-[3rem] relative border border-brand-100">
                                        <p className="text-brand-800 font-bold italic text-2xl leading-relaxed">"{formData.spiceReason}"</p>
                                    </div>
                                    <div className="flex gap-5">
                                        <button onClick={() => setView('cooking')} className="flex-1 py-5 text-slate-400 font-black text-xl hover:bg-slate-50 rounded-3xl transition-all">ÈáçÊñ∞Á†îÁôº</button>
                                        <button onClick={handlePublish} className="flex-[2] py-5 bg-brand-600 text-white font-black text-xl rounded-3xl shadow-2xl shadow-brand-100 hover:bg-brand-700 transition-all flex items-center justify-center gap-3">
                                            <Icon name="Share2" size={24}/> Á´Ø‰∏äÂ±ïÁ§∫ÁâÜ
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {view === 'gallery' && (
                        <div className="flex-1 bg-[#121212] text-white p-8 sm:p-20 flex flex-col">
                            <header className="flex flex-col md:flex-row justify-between items-start md:items-center gap-10 mb-20">
                                <div className="space-y-4">
                                    <div className="flex items-center gap-4">
                                        <div className="w-12 h-12 bg-brand-600 rounded-2xl flex items-center justify-center shadow-lg shadow-brand-600/20">
                                            <Icon name="Utensils" className="text-white" />
                                        </div>
                                        <h1 className="text-6xl font-black tracking-tighter">Êï∏‰ΩçËæ¶Ê°åÂ±ïÁ§∫ÁâÜ</h1>
                                    </div>
                                    <p className="text-slate-500 font-black text-xl tracking-widest uppercase ml-16">Â≠∏ÁøíÁôæÂë≥ÔºåÁõ°Âú®Ê≠§Âú∞</p>
                                </div>
                                <button onClick={() => { 
                                    setFormData({ creatorName: '', dishName: '', mainIngredient: '', methods: [], spices: [], spiceReason: '', skillLevel: 'ÂàùÂ≠∏', skillType: '', platingStyle: '', generatedImageUrl: null }); 
                                    setCurrentStep(0); setView('landing'); 
                                }} className="px-12 py-6 bg-brand-600 hover:bg-brand-700 text-white rounded-[2.5rem] font-black text-xl shadow-2xl shadow-brand-600/20 transition-all hover:scale-105 active:scale-95">
                                    ÈñãÁôºÊàëÁöÑÊñôÁêÜ
                                </button>
                            </header>
                            
                            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-12">
                                {galleryItems.length > 0 ? galleryItems.map((item) => (
                                    <div key={item.id} onClick={() => setSelectedItem(item)} className="group bg-[#1a1a1a] rounded-[3rem] overflow-hidden cursor-pointer hover:ring-8 ring-brand-500/30 transition-all duration-500 flex flex-col hover:-translate-y-4 shadow-2xl">
                                        <div className="aspect-square overflow-hidden relative">
                                            <img src={item.generatedImageUrl} className="w-full h-full object-cover grayscale-[0.2] group-hover:grayscale-0 transition-all duration-1000 group-hover:scale-110" loading="lazy" />
                                            <div className="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-90"></div>
                                            <div className="absolute bottom-6 left-6">
                                                <span className="bg-brand-600 text-[10px] font-black px-4 py-1.5 rounded-full shadow-2xl uppercase tracking-widest">{item.mainIngredient}</span>
                                            </div>
                                        </div>
                                        <div className="p-10 space-y-4">
                                            <h3 className="font-black text-3xl group-hover:text-brand-500 transition-colors truncate tracking-tighter">{item.dishName}</h3>
                                            <div className="text-slate-500 font-bold text-xs uppercase tracking-widest flex items-center gap-2">
                                                <div className="w-1.5 h-1.5 bg-slate-700 rounded-full"></div>
                                                CHEF {item.creatorName}
                                            </div>
                                            <p className="text-slate-400 text-sm italic line-clamp-2 opacity-60 leading-relaxed">"{item.spiceReason}"</p>
                                        </div>
                                    </div>
                                )) : (
                                    <div className="col-span-full py-40 text-center space-y-6 opacity-30">
                                        <Icon name="Utensils" size={80} className="mx-auto" />
                                        <p className="text-2xl font-black uppercase tracking-[0.4em]">Â±ïÁ§∫ÁâÜÂ∞öÁÑ°ÊñôÁêÜÔºåÊúüÂæÖÊÇ®ÁöÑÂÇë‰Ωú</p>
                                    </div>
                                )}
                            </div>

                            {selectedItem && (
                                <div className="fixed inset-0 z-[200] flex items-center justify-center p-6 bg-black/95 backdrop-blur-3xl animate-fade-in" onClick={() => setSelectedItem(null)}>
                                    <div className="bg-white rounded-[5rem] max-w-3xl w-full max-h-[90vh] overflow-y-auto text-slate-900 shadow-2xl animate-scale-up border-[2rem] border-white" onClick={e => e.stopPropagation()}>
                                        <div className="relative aspect-square rounded-[3.5rem] overflow-hidden dish-image-shadow">
                                            <img src={selectedItem.generatedImageUrl} className="w-full h-full object-cover" alt="Detail" />
                                            <button onClick={() => setSelectedItem(null)} className="absolute top-8 right-8 p-6 bg-black/20 hover:bg-black text-white rounded-[2rem] transition-all backdrop-blur-md">
                                                <Icon name="X" size={32} />
                                            </button>
                                        </div>
                                        <div className="p-16 space-y-12">
                                            <div className="border-b-2 border-slate-50 pb-10 flex flex-col gap-6">
                                                <div className="flex items-center gap-4">
                                                    <span className="bg-brand-600 text-white text-xs font-black px-5 py-2 rounded-full uppercase tracking-widest shadow-lg shadow-brand-600/20">{selectedItem.mainIngredient}</span>
                                                    <span className="bg-emerald-50 text-emerald-600 text-xs font-black px-5 py-2 rounded-full uppercase tracking-widest border border-emerald-100">{selectedItem.platingStyle}</span>
                                                </div>
                                                <h2 className="text-6xl font-black tracking-tighter leading-tight">{selectedItem.dishName}</h2>
                                                <div className="flex items-center gap-4 text-slate-400 font-black uppercase text-lg tracking-widest">
                                                    <div className="w-10 h-10 bg-slate-50 rounded-full flex items-center justify-center">
                                                        <Icon name="ChefHat" size={20} className="text-brand-500" />
                                                    </div>
                                                    <span>CHEFÔºö{selectedItem.creatorName}</span>
                                                </div>
                                            </div>
                                            <div className="bg-brand-50 p-12 rounded-[4rem] relative border-2 border-brand-100 shadow-inner">
                                                <p className="text-brand-950 font-black italic text-3xl leading-relaxed">"{selectedItem.spiceReason}"</p>
                                            </div>
                                            <button onClick={() => setSelectedItem(null)} className="w-full py-8 bg-slate-900 hover:bg-black text-white rounded-[2.5rem] font-black transition-all text-xl shadow-2xl">ÈóúÈñâË©≥ÊÉÖ</button>
                                        </div>
                                    </div>
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>